<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Details | Firelight Duel Academy - Yu-Gi-Oh! Trading Card Store</title>
    <meta name="description" content="View detailed information and pricing for Yu-Gi-Oh! trading cards at Firelight Duel Academy.">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../assets/css/modern-tcg-store.css">
    <link rel="icon" href="https://images.ygoprodeck.com/images/cards/89631139.jpg">
</head>
<body>
    <!-- Modern Header -->
    <header class="modern-header">
        <div class="header-container">
            <!-- Brand Section -->
            <div class="brand-section">
                <img src="https://images.ygoprodeck.com/images/cards/89631139.jpg" alt="Firelight Duel Academy" class="brand-logo">
                <div class="brand-text">
                    <a href="../index.html" class="brand-name">Firelight Duel Academy</a>
                    <span class="brand-tagline">Modern Yu-Gi-Oh! TCG Store</span>
                </div>
            </div>

            <!-- Navigation Section -->
            <nav class="nav-section">
                <ul class="nav-links">
                    <li><a href="../index.html" class="nav-link">Home</a></li>
                    <li><a href="singles.html" class="nav-link">Singles</a></li>
                    <li><a href="decks.html" class="nav-link">Decks</a></li>
                    <li><a href="events.html" class="nav-link">Events</a></li>
                    <li><a href="account.html" class="nav-link">Account</a></li>
                </ul>
            </nav>

            <!-- Search Section with Dropdown -->
            <div class="search-section">
                <div class="search-container">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" placeholder="Search Yu-Gi-Oh! cards..." id="search-dropdown-input">
                    <div class="search-dropdown" id="search-dropdown" style="display: none;">
                        <div class="search-results" id="search-results">
                            <!-- Search results will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Section -->
            <div class="action-section">
                <button class="action-btn" onclick="tcgStore.openCart()">
                    üõí Cart
                    <span class="cart-badge" style="display: none;">0</span>
                </button>
                <a href="account.html" class="action-btn">
                    üë§ Account
                </a>
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div style="max-width: 1400px; margin: 0 auto; padding: var(--space-4) var(--space-6);">
        <nav style="display: flex; align-items: center; gap: var(--space-2); font-size: 0.875rem; color: var(--gray-600);">
            <a href="../index.html" style="color: var(--primary-color); text-decoration: none;">Home</a>
            <span>‚Ä∫</span>
            <a href="singles.html" style="color: var(--primary-color); text-decoration: none;">Singles</a>
            <span>‚Ä∫</span>
            <span id="breadcrumb-card-name">Card Details</span>
        </nav>
    </div>

    <!-- Main Content -->
    <main style="max-width: 1400px; margin: 0 auto; padding: 0 var(--space-6) var(--space-12);">
        
        <!-- Loading State -->
        <div id="product-loading" class="loading-container">
            <div class="loading-spinner"></div>
            <p class="loading-text">Loading card details...</p>
        </div>

        <!-- Error State -->
        <div id="product-error" class="loading-container" style="display: none;">
            <p class="loading-text" style="color: var(--error-color);">Card not found. Please try again.</p>
            <a href="singles.html" style="padding: var(--space-3) var(--space-6); background: var(--primary-color); color: white; text-decoration: none; border-radius: var(--radius-md); font-weight: 600; margin-top: var(--space-4); display: inline-block;">Browse All Cards</a>
        </div>

        <!-- Product Content -->
        <div id="product-content" style="display: none;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-12); margin-bottom: var(--space-16);">
                
                <!-- Product Images -->
                <div>
                    <div style="background: white; border-radius: var(--radius-xl); box-shadow: var(--shadow-lg); padding: var(--space-6); border: 1px solid var(--gray-200);">
                        <div style="aspect-ratio: 3/4; max-width: min(120px, 15vw); max-height: 20vh; margin: 0 auto; background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%); border-radius: var(--radius-lg); overflow: hidden; margin-bottom: var(--space-4); cursor: pointer;" onclick="openImageZoom()">
                            <img id="main-card-image" src="" alt="" style="max-width: 100px; max-height: 140px; object-fit: contain; padding: var(--space-2); margin: 0 auto; display: block;">
                        </div>
                        <div style="display: flex; gap: var(--space-2); justify-content: center;">
                            <img id="thumb-normal" src="" alt="Normal view" style="width: 60px; height: 80px; object-fit: contain; border-radius: var(--radius-md); border: 2px solid var(--primary-color); cursor: pointer;" onclick="switchImage('normal')">
                            <img id="thumb-small" src="" alt="Small view" style="width: 60px; height: 80px; object-fit: contain; border-radius: var(--radius-md); border: 2px solid var(--gray-300); cursor: pointer;" onclick="switchImage('small')">
                        </div>
                    </div>
                </div>

                <!-- Product Information -->
                <div>
                    <div style="background: white; border-radius: var(--radius-xl); box-shadow: var(--shadow-lg); padding: var(--space-8); border: 1px solid var(--gray-200);">
                        
                        <!-- Product Header -->
                        <div style="margin-bottom: var(--space-6);">
                            <h1 id="product-title" style="font-size: 2.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-3); line-height: 1.2;"></h1>
                            <div style="display: flex; gap: var(--space-4); margin-bottom: var(--space-4);">
                                <span id="product-type" style="background: var(--primary-color); color: white; padding: var(--space-1) var(--space-3); border-radius: var(--radius-full); font-size: 0.875rem; font-weight: 600;"></span>
                                <span id="product-rarity" style="background: var(--secondary-color); color: var(--gray-900); padding: var(--space-1) var(--space-3); border-radius: var(--radius-full); font-size: 0.875rem; font-weight: 600;"></span>
                            </div>
                        </div>

                        <!-- Card Stats -->
                        <div id="card-stats" style="margin-bottom: var(--space-6);">
                            <!-- Stats will be populated by JavaScript -->
                        </div>

                        <!-- Pricing Section -->
                        <div style="background: var(--gray-50); border-radius: var(--radius-lg); padding: var(--space-6); margin-bottom: var(--space-6);">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-4);">
                                <span id="current-price" style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">$0.00</span>
                                <span id="price-trend" style="font-size: 0.875rem; font-weight: 600; padding: var(--space-1) var(--space-3); border-radius: var(--radius-md);"></span>
                            </div>
                        </div>

                        <!-- Sets and Rarities Section -->
                        <div id="sets-rarities-section" style="margin-bottom: var(--space-6); display: none;">
                            <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-3);">Available Sets & Rarities</h3>
                            <div style="background: var(--gray-50); border-radius: var(--radius-lg); padding: var(--space-4); margin-bottom: var(--space-4);">
                                <label style="display: block; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-2);">Select Set & Rarity:</label>
                                <select id="set-rarity-select" style="width: 100%; padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-md); font-size: 0.875rem;" onchange="updatePriceForSet()">
                                    <!-- Options will be populated by JavaScript -->
                                </select>
                            </div>
                        </div>

                        <!-- Add to Cart Section -->
                        <div style="margin-bottom: var(--space-6);">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); margin-bottom: var(--space-4);">
                                <div>
                                    <label style="display: block; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-2);">Quantity:</label>
                                    <div style="display: flex; align-items: center; border: 1px solid var(--gray-300); border-radius: var(--radius-md); overflow: hidden;">
                                        <button style="padding: var(--space-3); background: var(--gray-100); border: none; cursor: pointer;" onclick="changeQuantity(-1)">-</button>
                                        <input type="number" id="quantity" value="1" min="1" max="99" style="flex: 1; padding: var(--space-3); border: none; text-align: center; font-weight: 600;">
                                        <button style="padding: var(--space-3); background: var(--gray-100); border: none; cursor: pointer;" onclick="changeQuantity(1)">+</button>
                                    </div>
                                </div>
                                <div>
                                    <label style="display: block; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-2);">Condition:</label>
                                    <select id="condition" style="width: 100%; padding: var(--space-3); border: 1px solid var(--gray-300); border-radius: var(--radius-md); font-size: 0.875rem;">
                                        <option value="near_mint">Near Mint</option>
                                        <option value="lightly_played">Lightly Played (-10%)</option>
                                        <option value="moderately_played">Moderately Played (-20%)</option>
                                        <option value="heavily_played">Heavily Played (-35%)</option>
                                        <option value="damaged">Damaged (-50%)</option>
                                    </select>
                                </div>
                            </div>
                            <button id="add-to-cart-btn" style="width: 100%; padding: var(--space-4); background: var(--primary-color); color: white; border: none; border-radius: var(--radius-md); font-weight: 600; font-size: 1.125rem; cursor: pointer; transition: var(--transition-fast); text-transform: uppercase; letter-spacing: 0.05em;" onclick="addCurrentCardToCart()">
                                Add to Cart
                            </button>
                        </div>

                        <!-- Card Description -->
                        <div>
                            <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-3);">Card Description</h3>
                            <p id="card-description-text" style="color: var(--gray-700); line-height: 1.6;"></p>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Related Cards Section -->
            <div>
                <h2 style="font-size: 2rem; font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-8); text-align: center;">You May Also Like</h2>
                <div id="related-cards" class="modern-card-grid">
                    <!-- Related cards will be populated by JavaScript -->
                </div>
            </div>
        </div>

    </main>

    <!-- Image Zoom Modal -->
    <div id="image-zoom-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: var(--z-modal); align-items: center; justify-content: center;">
        <div style="position: relative; max-width: 90vw; max-height: 90vh;">
            <button onclick="closeImageZoom()" style="position: absolute; top: -40px; right: 0; background: none; border: none; color: white; font-size: 2rem; cursor: pointer;">√ó</button>
            <img id="zoomed-image" src="" alt="" style="max-width: 100%; max-height: 100%; object-fit: contain;">
        </div>
    </div>

    <!-- Footer -->
    <footer style="background: var(--gray-900); color: white; padding: var(--space-12) var(--space-6) var(--space-6); margin-top: var(--space-20);">
        <div style="max-width: 1400px; margin: 0 auto; text-align: center;">
            <p style="color: rgba(255,255,255,0.6); font-size: 0.875rem;">
                &copy; 2025 Firelight Duel Academy. All rights reserved.
            </p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="../assets/js/modern-tcg-store.js"></script>
    <script>
        let currentCard = null;

        // Load product on page load
        document.addEventListener('DOMContentLoaded', async function() {
            await loadProduct();
            setupSearchDropdown();
        });

        async function loadProduct() {
            const urlParams = new URLSearchParams(window.location.search);
            const cardId = urlParams.get('id');
            
            if (!cardId) {
                showError();
                return;
            }

            try {
                let card = null;
                if (!isNaN(cardId)) {
                    card = await tcgStore.getCardById(cardId);
                } else {
                    const cardName = cardId.replace(/-/g, ' ');
                    card = await tcgStore.getCardByName(cardName);
                }

                if (!card) {
                    showError();
                    return;
                }

                currentCard = tcgStore.formatCardForDisplay(card);
                displayProduct(currentCard);
                await loadRelatedCards(currentCard);
                
            } catch (error) {
                console.error('Error loading product:', error);
                showError();
            }
        }

        function displayProduct(card) {
            document.getElementById('product-loading').style.display = 'none';
            document.getElementById('product-content').style.display = 'block';

            document.title = `${card.name} | Firelight Duel Academy`;
            document.getElementById('breadcrumb-card-name').textContent = card.name;

            document.getElementById('product-title').textContent = card.name;
            document.getElementById('product-type').textContent = card.type;
            document.getElementById('product-rarity').textContent = card.rarity;

            document.getElementById('main-card-image').src = card.image;
            document.getElementById('main-card-image').alt = card.name;
            document.getElementById('thumb-normal').src = card.image;
            document.getElementById('thumb-small').src = card.imageSmall;

            displayCardStats(card);
            displaySetsAndRarities(card);

            document.getElementById('current-price').textContent = `$${card.price}`;
            const trendElement = document.getElementById('price-trend');
            const priceChange = card.priceChange;
            const symbol = priceChange.direction === 'up' ? '‚Üó' : priceChange.direction === 'down' ? '‚Üò' : '‚Üí';
            const changeText = priceChange.direction === 'stable' ? '$0.00' : 
                             (priceChange.direction === 'up' ? '+' : '-') + '$' + priceChange.amount;
            trendElement.textContent = `${symbol} ${changeText}`;
            trendElement.className = `price-trend ${priceChange.direction}`;

            document.getElementById('card-description-text').textContent = card.desc || 'No description available.';
        }

        function displayCardStats(card) {
            const statsContainer = document.getElementById('card-stats');
            let statsHTML = '';

            if (card.type.includes('Monster')) {
                if (card.atk !== undefined) {
                    statsHTML += `<div style="display: flex; justify-content: space-between; padding: var(--space-2) 0; border-bottom: 1px solid var(--gray-200);"><span style="font-weight: 600; color: var(--gray-700);">ATK:</span><span style="color: var(--gray-900);">${card.atk}</span></div>`;
                }
                if (card.def !== undefined) {
                    statsHTML += `<div style="display: flex; justify-content: space-between; padding: var(--space-2) 0; border-bottom: 1px solid var(--gray-200);"><span style="font-weight: 600; color: var(--gray-700);">DEF:</span><span style="color: var(--gray-900);">${card.def}</span></div>`;
                }
                if (card.level !== undefined) {
                    statsHTML += `<div style="display: flex; justify-content: space-between; padding: var(--space-2) 0; border-bottom: 1px solid var(--gray-200);"><span style="font-weight: 600; color: var(--gray-700);">Level:</span><span style="color: var(--gray-900);">${card.level}</span></div>`;
                }
                if (card.attribute) {
                    statsHTML += `<div style="display: flex; justify-content: space-between; padding: var(--space-2) 0; border-bottom: 1px solid var(--gray-200);"><span style="font-weight: 600; color: var(--gray-700);">Attribute:</span><span style="color: var(--gray-900);">${card.attribute}</span></div>`;
                }
                if (card.race) {
                    statsHTML += `<div style="display: flex; justify-content: space-between; padding: var(--space-2) 0;"><span style="font-weight: 600; color: var(--gray-700);">Type:</span><span style="color: var(--gray-900);">${card.race}</span></div>`;
                }
            }

            if (card.archetype) {
                statsHTML += `<div style="display: flex; justify-content: space-between; padding: var(--space-2) 0;"><span style="font-weight: 600; color: var(--gray-700);">Archetype:</span><span style="color: var(--gray-900);">${card.archetype}</span></div>`;
            }

            statsContainer.innerHTML = statsHTML;
        }

        function displaySetsAndRarities(card) {
            const setsSection = document.getElementById('sets-rarities-section');
            const setSelect = document.getElementById('set-rarity-select');
            
            if (!card.sets || !Array.isArray(card.sets) || card.sets.length === 0) {
                setsSection.style.display = 'none';
                return;
            }

            // Show the sets section
            setsSection.style.display = 'block';
            
            // Clear existing options
            setSelect.innerHTML = '';
            
            // Add default option
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = `Default - ${card.rarity} ($${card.price})`;
            defaultOption.selected = true;
            setSelect.appendChild(defaultOption);
            
            // Add options for each set
            card.sets.forEach((set, index) => {
                const option = document.createElement('option');
                option.value = index;
                
                // Generate different prices for different sets/rarities
                const setPrice = generateSetPrice(card.price, set);
                
                const setName = set.set_name || 'Unknown Set';
                const setCode = set.set_code || '';
                const setRarity = set.set_rarity || 'Common';
                
                option.textContent = `${setName} (${setCode}) - ${setRarity} ($${setPrice})`;
                option.dataset.price = setPrice;
                option.dataset.rarity = setRarity;
                option.dataset.setName = setName;
                option.dataset.setCode = setCode;
                
                setSelect.appendChild(option);
            });
        }

        function generateSetPrice(basePrice, set) {
            const base = parseFloat(basePrice) || 1.00;
            const setRarity = set.set_rarity || 'Common';
            
            // Price multipliers based on rarity
            const rarityMultipliers = {
                'Common': 0.8,
                'Rare': 1.0,
                'Super Rare': 1.5,
                'Ultra Rare': 2.0,
                'Secret Rare': 3.0,
                'Ultimate Rare': 4.0,
                'Ghost Rare': 5.0,
                'Starlight Rare': 10.0
            };
            
            const multiplier = rarityMultipliers[setRarity] || 1.0;
            const price = (base * multiplier).toFixed(2);
            
            return price;
        }

        function updatePriceForSet() {
            const setSelect = document.getElementById('set-rarity-select');
            const priceElement = document.getElementById('current-price');
            const rarityElement = document.getElementById('product-rarity');
            
            const selectedOption = setSelect.options[setSelect.selectedIndex];
            
            if (selectedOption && selectedOption.value !== '') {
                // Update price
                const newPrice = selectedOption.dataset.price;
                priceElement.textContent = `$${newPrice}`;
                
                // Update rarity display
                const newRarity = selectedOption.dataset.rarity;
                rarityElement.textContent = newRarity;
                
                // Update current card data for cart
                if (currentCard) {
                    currentCard.price = newPrice;
                    currentCard.rarity = newRarity;
                    currentCard.selectedSet = {
                        name: selectedOption.dataset.setName,
                        code: selectedOption.dataset.setCode,
                        rarity: newRarity
                    };
                }
            } else {
                // Reset to default values
                if (currentCard) {
                    const originalPrice = currentCard.originalPrice || currentCard.price;
                    const originalRarity = currentCard.originalRarity || currentCard.rarity;
                    
                    priceElement.textContent = `$${originalPrice}`;
                    rarityElement.textContent = originalRarity;
                    
                    currentCard.price = originalPrice;
                    currentCard.rarity = originalRarity;
                    currentCard.selectedSet = null;
                }
            }
        }

        async function loadRelatedCards(card) {
            const relatedContainer = document.getElementById('related-cards');
            
            try {
                let relatedCards = [];
                
                if (card.archetype) {
                    relatedCards = await tcgStore.getCardsByArchetype(card.archetype);
                    relatedCards = relatedCards.filter(c => c.id !== card.id).slice(0, 4);
                }
                
                if (relatedCards.length < 4) {
                    const metaCards = await tcgStore.getMetaCards();
                    const additionalCards = metaCards.filter(c => c.id !== card.id).slice(0, 4 - relatedCards.length);
                    relatedCards = [...relatedCards, ...additionalCards];
                }

                if (relatedCards.length === 0) {
                    relatedContainer.innerHTML = '<p style="text-align: center; color: var(--gray-600);">No related cards found.</p>';
                    return;
                }

                relatedContainer.innerHTML = '';
                relatedCards.forEach(relatedCard => {
                    const formatted = tcgStore.formatCardForDisplay(relatedCard);
                    const cardElement = tcgStore.createModernCardElement(formatted);
                    relatedContainer.appendChild(cardElement);
                });
                
            } catch (error) {
                console.error('Error loading related cards:', error);
                relatedContainer.innerHTML = '<p style="text-align: center; color: var(--gray-600);">Unable to load related cards.</p>';
            }
        }

        function showError() {
            document.getElementById('product-loading').style.display = 'none';
            document.getElementById('product-error').style.display = 'block';
        }

        function changeQuantity(delta) {
            const quantityInput = document.getElementById('quantity');
            const currentValue = parseInt(quantityInput.value) || 1;
            const newValue = Math.max(1, Math.min(99, currentValue + delta));
            quantityInput.value = newValue;
        }

        function switchImage(type) {
            if (!currentCard) return;
            
            const mainImage = document.getElementById('main-card-image');
            const thumbNormal = document.getElementById('thumb-normal');
            const thumbSmall = document.getElementById('thumb-small');
            
            thumbNormal.style.borderColor = '#d1d5db';
            thumbSmall.style.borderColor = '#d1d5db';
            
            if (type === 'normal') {
                mainImage.src = currentCard.image;
                thumbNormal.style.borderColor = 'var(--primary-color)';
            } else if (type === 'small') {
                mainImage.src = currentCard.imageSmall;
                thumbSmall.style.borderColor = 'var(--primary-color)';
            }
        }

        function openImageZoom() {
            if (!currentCard) return;
            
            const modal = document.getElementById('image-zoom-modal');
            const zoomedImage = document.getElementById('zoomed-image');
            
            zoomedImage.src = currentCard.image;
            zoomedImage.alt = currentCard.name;
            modal.style.display = 'flex';
        }

        function closeImageZoom() {
            document.getElementById('image-zoom-modal').style.display = 'none';
        }

        function addCurrentCardToCart() {
            if (!currentCard) return;
            
            const quantity = parseInt(document.getElementById('quantity').value) || 1;
            const condition = document.getElementById('condition').value;
            
            let price = parseFloat(currentCard.price);
            const conditionMultipliers = {
                'near_mint': 1.0,
                'lightly_played': 0.9,
                'moderately_played': 0.8,
                'heavily_played': 0.65,
                'damaged': 0.5
            };
            
            price *= conditionMultipliers[condition] || 1.0;
            
            for (let i = 0; i < quantity; i++) {
                tcgStore.addToCart(currentCard.name, price.toFixed(2), currentCard.image);
            }
        }

        function setupSearchDropdown() {
            const searchInput = document.getElementById('search-dropdown-input');
            const dropdown = document.getElementById('search-dropdown');
            const results = document.getElementById('search-results');

            searchInput.addEventListener('input', tcgStore.debounce(async function() {
                const query = searchInput.value.trim();
                if (query.length < 2) {
                    dropdown.style.display = 'none';
                    return;
                }

                try {
                    const cards = await tcgStore.searchCards(query);
                    if (cards.length > 0) {
                        results.innerHTML = '';
                        cards.slice(0, 5).forEach(card => {
                            const formatted = tcgStore.formatCardForDisplay(card);
                            const resultItem = document.createElement('div');
                            resultItem.style.cssText = 'display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); cursor: pointer; border-bottom: 1px solid var(--gray-200);';
                            resultItem.innerHTML = `
                                <img src="${formatted.imageSmall}" alt="${formatted.name}" style="width: 40px; height: 56px; object-fit: contain; border-radius: var(--radius-sm);">
                                <div>
                                    <div style="font-weight: 600; color: var(--gray-900);">${formatted.name}</div>
                                    <div style="font-size: 0.875rem; color: var(--gray-600);">${formatted.type} - $${formatted.price}</div>
                                </div>
                            `;
                            resultItem.onclick = () => {
                                window.location.href = `product.html?id=${formatted.id}`;
                            };
                            results.appendChild(resultItem);
                        });
                        dropdown.style.display = 'block';
                    } else {
                        dropdown.style.display = 'none';
                    }
                } catch (error) {
                    console.error('Search error:', error);
                    dropdown.style.display = 'none';
                }
            }, 300));

            searchInput.addEventListener('blur', () => {
                setTimeout(() => dropdown.style.display = 'none', 200);
            });
        }

        window.onclick = function(event) {
            const modal = document.getElementById('image-zoom-modal');
            if (event.target === modal) {
                closeImageZoom();
            }
        }
    </script>

    <style>
        .search-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            z-index: var(--z-dropdown);
            max-height: 300px;
            overflow-y: auto;
        }

        .search-results div:hover {
            background: var(--gray-50);
        }

        @media (max-width: 768px) {
            main > div:first-child {
                grid-template-columns: 1fr !important;
                gap: var(--space-8) !important;
            }
        }
    </style>
</body>
</html>

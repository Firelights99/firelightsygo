/**
 * Production-ready JavaScript
 * Console.log statements removed for production deployment
 * Generated by fix-code-quality.js
 */

/**
 * Home Page JavaScript
 * Handles home page specific functionality
 */

export async function initPage(params = '') {
    // Load meta cards when page loads
    await loadMetaCards();
}

async function loadMetaCards() {
    const metaCardsGrid = document.getElementById('meta-cards-grid');
    if (!metaCardsGrid) return;

    try {
        // Check if tcgStore is available
        if (!window.tcgStore) {
            console.warn('TCG Store not available, showing placeholder cards');
            showPlaceholderCards(metaCardsGrid);
            return;
        }

        // Load meta cards from the store
        const metaCards = await window.tcgStore.getMetaCards();
        
        if (metaCards && metaCards.length > 0) {
            metaCardsGrid.innerHTML = '';
            
            // Display first 8 meta cards
            const cardsToShow = metaCards.slice(0, 8);
            
            for (const card of cardsToShow) {
                const formattedCard = await window.tcgStore.formatCardForDisplay(card);
                const cardElement = window.tcgStore.createModernCardElement(formattedCard);
                metaCardsGrid.appendChild(cardElement);
            }
        } else {
            showPlaceholderCards(metaCardsGrid);
        }
    } catch (error) {
        console.error('Error loading meta cards:', error);
        showPlaceholderCards(metaCardsGrid);
    }
}

function showPlaceholderCards(container) {
    const placeholderCards = [
        { name: 'Snake-Eye Ash', price: '45.99', image: 'https://images.ygoprodeck.com/images/cards/back.jpg' },
        { name: 'Kashtira Fenrir', price: '32.50', image: 'https://images.ygoprodeck.com/images/cards/back.jpg' },
        { name: 'Ash Blossom & Joyous Spring', price: '28.75', image: 'https://images.ygoprodeck.com/images/cards/back.jpg' },
        { name: 'Maxx "C"', price: '15.99', image: 'https://images.ygoprodeck.com/images/cards/back.jpg' },
        { name: 'Nibiru, the Primal Being', price: '12.50', image: 'https://images.ygoprodeck.com/images/cards/back.jpg' },
        { name: 'Effect Veiler', price: '8.99', image: 'https://images.ygoprodeck.com/images/cards/back.jpg' },
        { name: 'Infinite Impermanence', price: '22.99', image: 'https://images.ygoprodeck.com/images/cards/back.jpg' },
        { name: 'Lightning Storm', price: '35.00', image: 'https://images.ygoprodeck.com/images/cards/back.jpg' }
    ];

    container.innerHTML = '';
    
    placeholderCards.forEach(card => {
        const cardElement = createPlaceholderCardElement(card);
        container.appendChild(cardElement);
    });
}

function createPlaceholderCardElement(card) {
    const cardDiv = document.createElement('div');
    cardDiv.className = 'modern-card';
    cardDiv.innerHTML = `
        <div class="card-image-container">
            <img src="${card.image}" alt="${card.name}" class="card-image" loading="lazy">
            <div class="card-overlay">
                <button class="card-action-btn" onclick="navigateTo('singles', '?search=${encodeURIComponent(card.name)}')">
                    View Details
                </button>
            </div>
        </div>
        <div class="card-info">
            <h3 class="card-name">${card.name}</h3>
            <div class="card-price">$${card.price} CAD</div>
            <div class="card-actions">
                <button class="add-to-cart-btn" onclick="addToCart('${card.name}', ${parseFloat(card.price)}, '${card.image}')">
                    Add to Cart
                </button>
            </div>
        </div>
    `;
    
    return cardDiv;
}

// Global function for adding cards to cart from home page
window.addToCart = function(cardName, price, image) {
    if (window.tcgStore) {
        window.tcgStore.addToCart(cardName, price, image);
    } else {
        console.log(`Added ${cardName} ($${price}) to cart`);
        alert(`${cardName} added to cart for $${price} CAD`);
    }
};
